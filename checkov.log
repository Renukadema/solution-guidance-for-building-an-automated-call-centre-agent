

       _               _              
   ___| |__   ___  ___| | _______   __
  / __| '_ \ / _ \/ __| |/ / _ \ \ / /
 | (__| | | |  __/ (__|   < (_) \ V / 
  \___|_| |_|\___|\___|_|\_\___/ \_/  
                                      
By Prisma Cloud | version: 3.2.2 
Update available 3.2.2 -> 3.2.51
Run pip3 install -U checkov to update 


serverless scan results:

Passed checks: 40, Failed checks: 18, Skipped checks: 0

Check: CKV_AWS_108: "Ensure IAM policies does not allow data exfiltration"
	PASSED for resource: AWS::IAM::Role.LambdaRole
	File: /serverless.yaml:128-143
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/ensure-iam-policies-do-not-allow-data-exfiltration
Check: CKV_AWS_111: "Ensure IAM policies does not allow write access without constraints"
	PASSED for resource: AWS::IAM::Role.LambdaRole
	File: /serverless.yaml:128-143
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/ensure-iam-policies-do-not-allow-write-access-without-constraint
Check: CKV_AWS_107: "Ensure IAM policies does not allow credentials exposure"
	PASSED for resource: AWS::IAM::Role.LambdaRole
	File: /serverless.yaml:128-143
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/ensure-iam-policies-do-not-allow-credentials-exposure
Check: CKV_AWS_61: "Ensure AWS IAM policy does not allow assume role permission across all services"
	PASSED for resource: AWS::IAM::Role.LambdaRole
	File: /serverless.yaml:128-143
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/bc-aws-iam-45
Check: CKV_AWS_109: "Ensure IAM policies does not allow permissions management without constraints"
	PASSED for resource: AWS::IAM::Role.LambdaRole
	File: /serverless.yaml:128-143
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/ensure-iam-policies-do-not-allow-permissions-management-resource-exposure-without-constraint
Check: CKV_AWS_60: "Ensure IAM role allows only specific services or principals to assume it"
	PASSED for resource: AWS::IAM::Role.LambdaRole
	File: /serverless.yaml:128-143
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/bc-aws-iam-44
Check: CKV_AWS_110: "Ensure IAM policies does not allow privilege escalation"
	PASSED for resource: AWS::IAM::Role.LambdaRole
	File: /serverless.yaml:128-143
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/ensure-iam-policies-does-not-allow-privilege-escalation
Check: CKV_AWS_108: "Ensure IAM policies does not allow data exfiltration"
	PASSED for resource: AWS::IAM::ManagedPolicy.LambdaPolicy
	File: /serverless.yaml:145-196
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/ensure-iam-policies-do-not-allow-data-exfiltration
Check: CKV_AWS_107: "Ensure IAM policies does not allow credentials exposure"
	PASSED for resource: AWS::IAM::ManagedPolicy.LambdaPolicy
	File: /serverless.yaml:145-196
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/ensure-iam-policies-do-not-allow-credentials-exposure
Check: CKV_AWS_109: "Ensure IAM policies does not allow permissions management without constraints"
	PASSED for resource: AWS::IAM::ManagedPolicy.LambdaPolicy
	File: /serverless.yaml:145-196
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/ensure-iam-policies-do-not-allow-permissions-management-resource-exposure-without-constraint
Check: CKV_AWS_110: "Ensure IAM policies does not allow privilege escalation"
	PASSED for resource: AWS::IAM::ManagedPolicy.LambdaPolicy
	File: /serverless.yaml:145-196
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/ensure-iam-policies-does-not-allow-privilege-escalation
Check: CKV_AWS_49: "Ensure no IAM policies documents allow "*" as a statement's actions"
	PASSED for resource: startstreaming
	File: /serverless.yaml:34-45
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/bc-aws-iam-43
Check: CKV_AWS_41: "Ensure no hard coded AWS access key and secret key exists in provider"
	PASSED for resource: startstreaming
	File: /serverless.yaml:34-45
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/secrets-policies/bc-aws-secrets-5
Check: CKV_AWS_1: "Ensure IAM policies that allow full "*-*" administrative privileges are not created"
	PASSED for resource: startstreaming
	File: /serverless.yaml:34-45
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/iam-23
Check: CKV_AWS_49: "Ensure no IAM policies documents allow "*" as a statement's actions"
	PASSED for resource: processstream
	File: /serverless.yaml:46-64
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/bc-aws-iam-43
Check: CKV_AWS_41: "Ensure no hard coded AWS access key and secret key exists in provider"
	PASSED for resource: processstream
	File: /serverless.yaml:46-64
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/secrets-policies/bc-aws-secrets-5
Check: CKV_AWS_1: "Ensure IAM policies that allow full "*-*" administrative privileges are not created"
	PASSED for resource: processstream
	File: /serverless.yaml:46-64
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/iam-23
Check: CKV_AWS_49: "Ensure no IAM policies documents allow "*" as a statement's actions"
	PASSED for resource: virtualagent
	File: /serverless.yaml:65-76
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/bc-aws-iam-43
Check: CKV_AWS_41: "Ensure no hard coded AWS access key and secret key exists in provider"
	PASSED for resource: virtualagent
	File: /serverless.yaml:65-76
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/secrets-policies/bc-aws-secrets-5
Check: CKV_AWS_1: "Ensure IAM policies that allow full "*-*" administrative privileges are not created"
	PASSED for resource: virtualagent
	File: /serverless.yaml:65-76
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/iam-23
Check: CKV_AWS_108: "Ensure IAM policies does not allow data exfiltration"
	PASSED for resource: AWS::IAM::Role.LambdaRole
	File: /ConnectVoice/serverless.yaml:128-143
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/ensure-iam-policies-do-not-allow-data-exfiltration
Check: CKV_AWS_111: "Ensure IAM policies does not allow write access without constraints"
	PASSED for resource: AWS::IAM::Role.LambdaRole
	File: /ConnectVoice/serverless.yaml:128-143
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/ensure-iam-policies-do-not-allow-write-access-without-constraint
Check: CKV_AWS_107: "Ensure IAM policies does not allow credentials exposure"
	PASSED for resource: AWS::IAM::Role.LambdaRole
	File: /ConnectVoice/serverless.yaml:128-143
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/ensure-iam-policies-do-not-allow-credentials-exposure
Check: CKV_AWS_61: "Ensure AWS IAM policy does not allow assume role permission across all services"
	PASSED for resource: AWS::IAM::Role.LambdaRole
	File: /ConnectVoice/serverless.yaml:128-143
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/bc-aws-iam-45
Check: CKV_AWS_109: "Ensure IAM policies does not allow permissions management without constraints"
	PASSED for resource: AWS::IAM::Role.LambdaRole
	File: /ConnectVoice/serverless.yaml:128-143
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/ensure-iam-policies-do-not-allow-permissions-management-resource-exposure-without-constraint
Check: CKV_AWS_60: "Ensure IAM role allows only specific services or principals to assume it"
	PASSED for resource: AWS::IAM::Role.LambdaRole
	File: /ConnectVoice/serverless.yaml:128-143
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/bc-aws-iam-44
Check: CKV_AWS_110: "Ensure IAM policies does not allow privilege escalation"
	PASSED for resource: AWS::IAM::Role.LambdaRole
	File: /ConnectVoice/serverless.yaml:128-143
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/ensure-iam-policies-does-not-allow-privilege-escalation
Check: CKV_AWS_108: "Ensure IAM policies does not allow data exfiltration"
	PASSED for resource: AWS::IAM::ManagedPolicy.LambdaPolicy
	File: /ConnectVoice/serverless.yaml:145-196
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/ensure-iam-policies-do-not-allow-data-exfiltration
Check: CKV_AWS_107: "Ensure IAM policies does not allow credentials exposure"
	PASSED for resource: AWS::IAM::ManagedPolicy.LambdaPolicy
	File: /ConnectVoice/serverless.yaml:145-196
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/ensure-iam-policies-do-not-allow-credentials-exposure
Check: CKV_AWS_109: "Ensure IAM policies does not allow permissions management without constraints"
	PASSED for resource: AWS::IAM::ManagedPolicy.LambdaPolicy
	File: /ConnectVoice/serverless.yaml:145-196
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/ensure-iam-policies-do-not-allow-permissions-management-resource-exposure-without-constraint
Check: CKV_AWS_110: "Ensure IAM policies does not allow privilege escalation"
	PASSED for resource: AWS::IAM::ManagedPolicy.LambdaPolicy
	File: /ConnectVoice/serverless.yaml:145-196
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/ensure-iam-policies-does-not-allow-privilege-escalation
Check: CKV_AWS_49: "Ensure no IAM policies documents allow "*" as a statement's actions"
	PASSED for resource: startstreaming
	File: /ConnectVoice/serverless.yaml:34-45
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/bc-aws-iam-43
Check: CKV_AWS_41: "Ensure no hard coded AWS access key and secret key exists in provider"
	PASSED for resource: startstreaming
	File: /ConnectVoice/serverless.yaml:34-45
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/secrets-policies/bc-aws-secrets-5
Check: CKV_AWS_1: "Ensure IAM policies that allow full "*-*" administrative privileges are not created"
	PASSED for resource: startstreaming
	File: /ConnectVoice/serverless.yaml:34-45
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/iam-23
Check: CKV_AWS_49: "Ensure no IAM policies documents allow "*" as a statement's actions"
	PASSED for resource: processstream
	File: /ConnectVoice/serverless.yaml:46-64
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/bc-aws-iam-43
Check: CKV_AWS_41: "Ensure no hard coded AWS access key and secret key exists in provider"
	PASSED for resource: processstream
	File: /ConnectVoice/serverless.yaml:46-64
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/secrets-policies/bc-aws-secrets-5
Check: CKV_AWS_1: "Ensure IAM policies that allow full "*-*" administrative privileges are not created"
	PASSED for resource: processstream
	File: /ConnectVoice/serverless.yaml:46-64
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/iam-23
Check: CKV_AWS_49: "Ensure no IAM policies documents allow "*" as a statement's actions"
	PASSED for resource: virtualagent
	File: /ConnectVoice/serverless.yaml:65-76
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/bc-aws-iam-43
Check: CKV_AWS_41: "Ensure no hard coded AWS access key and secret key exists in provider"
	PASSED for resource: virtualagent
	File: /ConnectVoice/serverless.yaml:65-76
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/secrets-policies/bc-aws-secrets-5
Check: CKV_AWS_1: "Ensure IAM policies that allow full "*-*" administrative privileges are not created"
	PASSED for resource: virtualagent
	File: /ConnectVoice/serverless.yaml:65-76
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/iam-23
Check: CKV_AWS_28: "Ensure DynamoDB point in time recovery (backup) is enabled"
	FAILED for resource: AWS::DynamoDB::Table.TranscriptsTable
	File: /serverless.yaml:82-98
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/general-6

		82 |     TranscriptsTable:
		83 |       Type: 'AWS::DynamoDB::Table'
		84 |       Properties:
		85 |         TableName: '${self:provider.stage}-${self:service}-transcripts'
		86 |         AttributeDefinitions:
		87 |           - AttributeName: contactId
		88 |             AttributeType: S
		89 |           - AttributeName: transcriptId
		90 |             AttributeType: S
		91 |         KeySchema:
		92 |           - AttributeName: contactId
		93 |             KeyType: HASH
		94 |           - AttributeName: transcriptId
		95 |             KeyType: RANGE
		96 |         BillingMode: PAY_PER_REQUEST
		97 | 
		98 |     # Table for messages

Check: CKV_AWS_119: "Ensure DynamoDB Tables are encrypted using a KMS Customer Managed CMK"
	FAILED for resource: AWS::DynamoDB::Table.TranscriptsTable
	File: /serverless.yaml:82-98
	Guide: https://docs.bridgecrew.io/docs/ensure-that-dynamodb-tables-are-encrypted

		82 |     TranscriptsTable:
		83 |       Type: 'AWS::DynamoDB::Table'
		84 |       Properties:
		85 |         TableName: '${self:provider.stage}-${self:service}-transcripts'
		86 |         AttributeDefinitions:
		87 |           - AttributeName: contactId
		88 |             AttributeType: S
		89 |           - AttributeName: transcriptId
		90 |             AttributeType: S
		91 |         KeySchema:
		92 |           - AttributeName: contactId
		93 |             KeyType: HASH
		94 |           - AttributeName: transcriptId
		95 |             KeyType: RANGE
		96 |         BillingMode: PAY_PER_REQUEST
		97 | 
		98 |     # Table for messages

Check: CKV_AWS_28: "Ensure DynamoDB point in time recovery (backup) is enabled"
	FAILED for resource: AWS::DynamoDB::Table.MessagesTable
	File: /serverless.yaml:99-115
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/general-6

		99  |     MessagesTable:
		100 |       Type: 'AWS::DynamoDB::Table'
		101 |       Properties:
		102 |         TableName: '${self:provider.stage}-${self:service}-messages'
		103 |         AttributeDefinitions:
		104 |           - AttributeName: contactId
		105 |             AttributeType: S
		106 |           - AttributeName: messageId
		107 |             AttributeType: S
		108 |         KeySchema:
		109 |           - AttributeName: contactId
		110 |             KeyType: HASH
		111 |           - AttributeName: messageId
		112 |             KeyType: RANGE
		113 |         BillingMode: PAY_PER_REQUEST
		114 | 
		115 |     # Table for for the next message and action

Check: CKV_AWS_119: "Ensure DynamoDB Tables are encrypted using a KMS Customer Managed CMK"
	FAILED for resource: AWS::DynamoDB::Table.MessagesTable
	File: /serverless.yaml:99-115
	Guide: https://docs.bridgecrew.io/docs/ensure-that-dynamodb-tables-are-encrypted

		99  |     MessagesTable:
		100 |       Type: 'AWS::DynamoDB::Table'
		101 |       Properties:
		102 |         TableName: '${self:provider.stage}-${self:service}-messages'
		103 |         AttributeDefinitions:
		104 |           - AttributeName: contactId
		105 |             AttributeType: S
		106 |           - AttributeName: messageId
		107 |             AttributeType: S
		108 |         KeySchema:
		109 |           - AttributeName: contactId
		110 |             KeyType: HASH
		111 |           - AttributeName: messageId
		112 |             KeyType: RANGE
		113 |         BillingMode: PAY_PER_REQUEST
		114 | 
		115 |     # Table for for the next message and action

Check: CKV_AWS_28: "Ensure DynamoDB point in time recovery (backup) is enabled"
	FAILED for resource: AWS::DynamoDB::Table.NextMessageTable
	File: /serverless.yaml:116-126
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/general-6

		116 |     NextMessageTable:
		117 |       Type: 'AWS::DynamoDB::Table'
		118 |       Properties:
		119 |         TableName: '${self:provider.stage}-${self:service}-nextmessage'
		120 |         AttributeDefinitions:
		121 |           - AttributeName: contactId
		122 |             AttributeType: S
		123 |         KeySchema:
		124 |           - AttributeName: contactId
		125 |             KeyType: HASH
		126 |         BillingMode: PAY_PER_REQUEST

Check: CKV_AWS_119: "Ensure DynamoDB Tables are encrypted using a KMS Customer Managed CMK"
	FAILED for resource: AWS::DynamoDB::Table.NextMessageTable
	File: /serverless.yaml:116-126
	Guide: https://docs.bridgecrew.io/docs/ensure-that-dynamodb-tables-are-encrypted

		116 |     NextMessageTable:
		117 |       Type: 'AWS::DynamoDB::Table'
		118 |       Properties:
		119 |         TableName: '${self:provider.stage}-${self:service}-nextmessage'
		120 |         AttributeDefinitions:
		121 |           - AttributeName: contactId
		122 |             AttributeType: S
		123 |         KeySchema:
		124 |           - AttributeName: contactId
		125 |             KeyType: HASH
		126 |         BillingMode: PAY_PER_REQUEST

Check: CKV_AWS_111: "Ensure IAM policies does not allow write access without constraints"
	FAILED for resource: AWS::IAM::ManagedPolicy.LambdaPolicy
	File: /serverless.yaml:145-196
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/ensure-iam-policies-do-not-allow-write-access-without-constraint

		Code lines for this resource are too many. Please use IDE of your choice to review the file.
Check: CKV_AWS_27: "Ensure all data stored in the SQS queue is encrypted"
	FAILED for resource: AWS::SQS::Queue.ProcessQueue
	File: /serverless.yaml:198-207
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/general-16-encrypt-sqs-queue

		198 |     ProcessQueue:
		199 |       Type: AWS::SQS::Queue
		200 |       Properties:
		201 |         MaximumMessageSize: 1024
		202 |         MessageRetentionPeriod: 1209600
		203 |         QueueName: !Sub '${self:provider.stage}-${self:service}-process'
		204 |         VisibilityTimeout: 1000
		205 |         RedrivePolicy:
		206 |           deadLetterTargetArn: !GetAtt ProcessRedriveQueue.Arn
		207 |           maxReceiveCount: 1

Check: CKV_AWS_27: "Ensure all data stored in the SQS queue is encrypted"
	FAILED for resource: AWS::SQS::Queue.ProcessRedriveQueue
	File: /serverless.yaml:209-215
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/general-16-encrypt-sqs-queue

		209 |     ProcessRedriveQueue:
		210 |       Type: AWS::SQS::Queue
		211 |       Properties:
		212 |         MaximumMessageSize: 1024
		213 |         MessageRetentionPeriod: 1209600
		214 |         QueueName: !Sub '${self:provider.stage}-${self:service}-process-redrive'
		215 |         VisibilityTimeout: 120
Check: CKV_AWS_28: "Ensure DynamoDB point in time recovery (backup) is enabled"
	FAILED for resource: AWS::DynamoDB::Table.TranscriptsTable
	File: /ConnectVoice/serverless.yaml:82-98
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/general-6

		82 |     TranscriptsTable:
		83 |       Type: 'AWS::DynamoDB::Table'
		84 |       Properties:
		85 |         TableName: '${self:provider.stage}-${self:service}-transcripts'
		86 |         AttributeDefinitions:
		87 |           - AttributeName: contactId
		88 |             AttributeType: S
		89 |           - AttributeName: transcriptId
		90 |             AttributeType: S
		91 |         KeySchema:
		92 |           - AttributeName: contactId
		93 |             KeyType: HASH
		94 |           - AttributeName: transcriptId
		95 |             KeyType: RANGE
		96 |         BillingMode: PAY_PER_REQUEST
		97 | 
		98 |     # Table for messages

Check: CKV_AWS_119: "Ensure DynamoDB Tables are encrypted using a KMS Customer Managed CMK"
	FAILED for resource: AWS::DynamoDB::Table.TranscriptsTable
	File: /ConnectVoice/serverless.yaml:82-98
	Guide: https://docs.bridgecrew.io/docs/ensure-that-dynamodb-tables-are-encrypted

		82 |     TranscriptsTable:
		83 |       Type: 'AWS::DynamoDB::Table'
		84 |       Properties:
		85 |         TableName: '${self:provider.stage}-${self:service}-transcripts'
		86 |         AttributeDefinitions:
		87 |           - AttributeName: contactId
		88 |             AttributeType: S
		89 |           - AttributeName: transcriptId
		90 |             AttributeType: S
		91 |         KeySchema:
		92 |           - AttributeName: contactId
		93 |             KeyType: HASH
		94 |           - AttributeName: transcriptId
		95 |             KeyType: RANGE
		96 |         BillingMode: PAY_PER_REQUEST
		97 | 
		98 |     # Table for messages

Check: CKV_AWS_28: "Ensure DynamoDB point in time recovery (backup) is enabled"
	FAILED for resource: AWS::DynamoDB::Table.MessagesTable
	File: /ConnectVoice/serverless.yaml:99-115
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/general-6

		99  |     MessagesTable:
		100 |       Type: 'AWS::DynamoDB::Table'
		101 |       Properties:
		102 |         TableName: '${self:provider.stage}-${self:service}-messages'
		103 |         AttributeDefinitions:
		104 |           - AttributeName: contactId
		105 |             AttributeType: S
		106 |           - AttributeName: messageId
		107 |             AttributeType: S
		108 |         KeySchema:
		109 |           - AttributeName: contactId
		110 |             KeyType: HASH
		111 |           - AttributeName: messageId
		112 |             KeyType: RANGE
		113 |         BillingMode: PAY_PER_REQUEST
		114 | 
		115 |     # Table for for the next message and action

Check: CKV_AWS_119: "Ensure DynamoDB Tables are encrypted using a KMS Customer Managed CMK"
	FAILED for resource: AWS::DynamoDB::Table.MessagesTable
	File: /ConnectVoice/serverless.yaml:99-115
	Guide: https://docs.bridgecrew.io/docs/ensure-that-dynamodb-tables-are-encrypted

		99  |     MessagesTable:
		100 |       Type: 'AWS::DynamoDB::Table'
		101 |       Properties:
		102 |         TableName: '${self:provider.stage}-${self:service}-messages'
		103 |         AttributeDefinitions:
		104 |           - AttributeName: contactId
		105 |             AttributeType: S
		106 |           - AttributeName: messageId
		107 |             AttributeType: S
		108 |         KeySchema:
		109 |           - AttributeName: contactId
		110 |             KeyType: HASH
		111 |           - AttributeName: messageId
		112 |             KeyType: RANGE
		113 |         BillingMode: PAY_PER_REQUEST
		114 | 
		115 |     # Table for for the next message and action

Check: CKV_AWS_28: "Ensure DynamoDB point in time recovery (backup) is enabled"
	FAILED for resource: AWS::DynamoDB::Table.NextMessageTable
	File: /ConnectVoice/serverless.yaml:116-126
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/general-6

		116 |     NextMessageTable:
		117 |       Type: 'AWS::DynamoDB::Table'
		118 |       Properties:
		119 |         TableName: '${self:provider.stage}-${self:service}-nextmessage'
		120 |         AttributeDefinitions:
		121 |           - AttributeName: contactId
		122 |             AttributeType: S
		123 |         KeySchema:
		124 |           - AttributeName: contactId
		125 |             KeyType: HASH
		126 |         BillingMode: PAY_PER_REQUEST

Check: CKV_AWS_119: "Ensure DynamoDB Tables are encrypted using a KMS Customer Managed CMK"
	FAILED for resource: AWS::DynamoDB::Table.NextMessageTable
	File: /ConnectVoice/serverless.yaml:116-126
	Guide: https://docs.bridgecrew.io/docs/ensure-that-dynamodb-tables-are-encrypted

		116 |     NextMessageTable:
		117 |       Type: 'AWS::DynamoDB::Table'
		118 |       Properties:
		119 |         TableName: '${self:provider.stage}-${self:service}-nextmessage'
		120 |         AttributeDefinitions:
		121 |           - AttributeName: contactId
		122 |             AttributeType: S
		123 |         KeySchema:
		124 |           - AttributeName: contactId
		125 |             KeyType: HASH
		126 |         BillingMode: PAY_PER_REQUEST

Check: CKV_AWS_111: "Ensure IAM policies does not allow write access without constraints"
	FAILED for resource: AWS::IAM::ManagedPolicy.LambdaPolicy
	File: /ConnectVoice/serverless.yaml:145-196
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/ensure-iam-policies-do-not-allow-write-access-without-constraint

		Code lines for this resource are too many. Please use IDE of your choice to review the file.
Check: CKV_AWS_27: "Ensure all data stored in the SQS queue is encrypted"
	FAILED for resource: AWS::SQS::Queue.ProcessQueue
	File: /ConnectVoice/serverless.yaml:198-207
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/general-16-encrypt-sqs-queue

		198 |     ProcessQueue:
		199 |       Type: AWS::SQS::Queue
		200 |       Properties:
		201 |         MaximumMessageSize: 1024
		202 |         MessageRetentionPeriod: 1209600
		203 |         QueueName: !Sub '${self:provider.stage}-${self:service}-process'
		204 |         VisibilityTimeout: 1000
		205 |         RedrivePolicy:
		206 |           deadLetterTargetArn: !GetAtt ProcessRedriveQueue.Arn
		207 |           maxReceiveCount: 1

Check: CKV_AWS_27: "Ensure all data stored in the SQS queue is encrypted"
	FAILED for resource: AWS::SQS::Queue.ProcessRedriveQueue
	File: /ConnectVoice/serverless.yaml:209-215
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/general-16-encrypt-sqs-queue

		209 |     ProcessRedriveQueue:
		210 |       Type: AWS::SQS::Queue
		211 |       Properties:
		212 |         MaximumMessageSize: 1024
		213 |         MessageRetentionPeriod: 1209600
		214 |         QueueName: !Sub '${self:provider.stage}-${self:service}-process-redrive'
		215 |         VisibilityTimeout: 120

